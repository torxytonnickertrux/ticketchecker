{% extends "base.html" %}
{% block title %}Eventos{% endblock %}
{% block content %}
<section class="container">
  <h1 class="mb-3">Todos os eventos</h1>

  <form method="get" class="mb-3">
    {{ form.non_field_errors }}
    <div class="field">
      <label for="{{ form.search.id_for_label }}">{{ form.search.label }}</label>
      {{ form.search }}
    </div>
    <div class="field">
      <label for="{{ form.date_from.id_for_label }}">{{ form.date_from.label }}</label>
      {{ form.date_from }}
    </div>
    <div class="field">
      <label for="{{ form.date_to.id_for_label }}">{{ form.date_to.label }}</label>
      {{ form.date_to }}
    </div>
    <div class="field">
      <label for="{{ form.location.id_for_label }}">{{ form.location.label }}</label>
      {{ form.location }}
    </div>
    <button class="btn btn-primary" type="submit">Filtrar</button>
    <a class="btn btn-link" href="{% url 'event_list' %}">Limpar</a>
  </form>

  {% if page_obj.object_list %}
  <div class="card-grid">
    {% for event in page_obj.object_list %}
    <div class="card" style="margin-bottom:16px;">
      {% if event.image %}
      <img src="{{ event.image.url }}" alt="{{ event.name }}" class="card-image" />
      {% endif %}
      <div class="card-content">
        <h2 class="card-title">{{ event.name }}</h2>
        <p class="card-text">{{ event.description|truncatechars:140 }}</p>
        <p class="card-meta">{{ event.date|date:"d/m/Y H:i" }} • {{ event.location }}</p>
        <a class="btn btn-primary" href="{% url 'event_detail' event.id %}">Ver detalhes</a>
      </div>
    </div>
    {% endfor %}
  </div>

  <div class="pagination">
    {% if page_obj.has_previous %}
      <a class="btn" href="?page={{ page_obj.previous_page_number }}">Anterior</a>
    {% endif %}
    <span>Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}</span>
    {% if page_obj.has_next %}
      <a class="btn" href="?page={{ page_obj.next_page_number }}">Próxima</a>
    {% endif %}
  </div>
  {% else %}
  <p>Nenhum evento encontrado.</p>
  {% endif %}
</section>
{% endblock %}