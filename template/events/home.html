{% extends "base.html" %}
{% load static %}
{% block title %}Início{% endblock %}

{% block extra_head %}
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
  <style>
    .hero { display: grid; grid-template-columns: 1.2fr 0.8fr; gap: 24px; align-items: center; }
    .hero .copy { padding: 12px 0; }
    .hero .copy h1 { font-size: 32px; line-height: 1.2; margin: 0 0 12px; }
    .hero .copy p { color: var(--muted); margin: 0 0 16px; }
    .hero .actions { display: flex; gap: 12px; flex-wrap: wrap; }
    .hero .brand-logo { width: 160px; height: 160px; border-radius: 16px; display: block; object-fit: contain; background: transparent; }

    /* Swiper */
    .swiper { width: 100%; height: 340px; }
    .swiper-slide { position: relative; border-radius: 14px; overflow: hidden; }
    .slide-image { width: 100%; height: 100%; object-fit: cover; }
    .slide-overlay { position: absolute; inset: 0; background: linear-gradient(180deg, rgba(2,6,23,0.0), rgba(2,6,23,0.55)); }
    .slide-content { position: absolute; left: 16px; right: 16px; bottom: 16px; color: #fff; }
    .slide-title { font-size: 22px; margin-bottom: 6px; }
    .slide-meta { font-size: 14px; opacity: 0.9; margin-bottom: 10px; }

    /* Categorias */
    .categories { margin-top: 24px; }
    .cat-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 12px; }
    .cat-card { padding: 14px; border: 1px solid var(--ring); border-radius: 12px; background: #f8fafc; display: flex; align-items: center; justify-content: space-between; cursor: pointer; text-decoration: none; color: var(--primary); }
    .cat-card:hover { background: #eef2ff; border-color: #c7d2fe; }
    .cat-name { font-weight: 700; }
    .cat-count { color: var(--muted); font-size: 13px; }

    /* Preços */
    .pricing { margin-top: 28px; }
    .price-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 16px; }
    .price-card { border: 1px solid var(--ring); border-radius: 14px; padding: 16px; background: var(--card); }
    .price-card h3 { margin: 0 0 8px; font-size: 18px; }
    .price { font-size: 28px; font-weight: 800; color: var(--accent); }
    .features { margin: 12px 0; color: var(--muted); }
    .features li { margin: 6px 0; }
  </style>
{% endblock %}

{% block content %}
  <!-- Herói com logo e copy -->
  <section class="hero" aria-label="Apresentação">
    <div class="copy">
      <h1>Venda ingressos com facilidade e aumente sua conversão</h1>
      <p>Plataforma moderna para gestão de eventos, emissão de ingressos e pagamentos PIX/cartão. Interface rápida, segura e feita para maximizar resultados.</p>
        <div class="actions">
          <a class="btn btn-primary" href="{% url 'event_list' %}">Explorar eventos</a>
          {% if not request.user.is_authenticated %}
            <a class="btn" style="background:#e2e8f0;" href="{% url 'users:register' %}">Criar conta</a>
          {% endif %}
        </div>
    </div>
        <img class="brand-logo" src="{% static 'image/logo.png' %}" alt="TicketChecker logo" />
  </section>

  <!-- Slider de eventos em destaque -->
  <section class="mt-3" aria-label="Eventos em destaque">
    {% if featured_events %}
    <div class="swiper">
      <div class="swiper-wrapper">
        {% for event in featured_events %}
          <div class="swiper-slide">
            {% if event.image %}
            <img class="slide-image" src="{{ event.image.url }}" alt="{{ event.name }}" />
            {% else %}
            <div class="slide-image" style="background:#e2e8f0; display:grid; place-items:center; color:#0f172a;">{{ event.name }}</div>
            {% endif %}
            <div class="slide-overlay" aria-hidden="true"></div>
            <div class="slide-content">
              <div class="slide-title">{{ event.name }}</div>
              <div class="slide-meta">{{ event.date|date:"d/m/Y H:i" }} • {{ event.location }}</div>
              <a class="btn btn-primary" href="{% url 'event_detail' event.id %}">Ver detalhes</a>
            </div>
          </div>
        {% endfor %}
      </div>
      <div class="swiper-pagination" aria-hidden="true"></div>
      <div class="swiper-button-prev" aria-label="Slide anterior"></div>
      <div class="swiper-button-next" aria-label="Próximo slide"></div>
    </div>
    {% else %}
      <p>Nenhum evento em destaque no momento.</p>
      <a class="btn btn-link" href="{% url 'event_list' %}">Ver todos os eventos</a>
    {% endif %}
  </section>

  {% if user.is_authenticated %}
  <!-- Eventos do usuário -->
  {% if user_events %}
  <section class="mt-3" aria-label="Seus próximos eventos">
    <h2 class="mb-2">Seus próximos eventos</h2>
    <div class="card-grid">
      {% for event in user_events %}
      <div class="card">
        {% if event.image %}
        <img src="{{ event.image.url }}" alt="{{ event.name }}" class="card-image" />
        {% endif %}
        <div class="card-content">
          <h3 class="card-title">{{ event.name }}</h3>
          <p class="card-meta">{{ event.date|date:"d/m/Y H:i" }} • {{ event.location }}</p>
          <a class="btn btn-primary" href="{% url 'event_detail' event.id %}">Ver detalhes</a>
        </div>
      </div>
      {% endfor %}
    </div>
  </section>
  {% endif %}

  <!-- Recomendações -->
  {% if recommended_events %}
  <section class="mt-3" aria-label="Recomendado para você">
    <h2 class="mb-2">Recomendado para você</h2>
    {% if last_ticket_types %}
    <p class="mb-2" style="color:var(--muted)">Com base nos seus ingressos: {{ last_ticket_types|join:", " }}</p>
    {% endif %}
    <div class="card-grid">
      {% for event in recommended_events %}
      <div class="card">
        {% if event.image %}
        <img src="{{ event.image.url }}" alt="{{ event.name }}" class="card-image" />
        {% endif %}
        <div class="card-content">
          <h3 class="card-title">{{ event.name }}</h3>
          <p class="card-meta">{{ event.date|date:"d/m/Y H:i" }} • {{ event.location }}</p>
          <a class="btn btn-primary" href="{% url 'event_detail' event.id %}">Ver detalhes</a>
        </div>
      </div>
      {% endfor %}
    </div>
  </section>
  {% endif %}
  {% endif %}

  <!-- Categorias de eventos -->
  <section class="categories" aria-label="Categorias de eventos">
    <h2 class="mb-2">Explore por categoria</h2>
    <div class="cat-grid">
      <a class="cat-card" href="{% url 'event_list' %}?search=Show">
        <span class="cat-name">Shows</span><span class="cat-count">Música ao vivo</span>
      </a>
      <a class="cat-card" href="{% url 'event_list' %}?search=Teatro">
        <span class="cat-name">Teatro</span><span class="cat-count">Peças e performances</span>
      </a>
      <a class="cat-card" href="{% url 'event_list' %}?search=Festival">
        <span class="cat-name">Festivais</span><span class="cat-count">Grandes experiências</span>
      </a>
      <a class="cat-card" href="{% url 'event_list' %}?search=Conferência">
        <span class="cat-name">Conferências</span><span class="cat-count">Negócios e networking</span>
      </a>
      <a class="cat-card" href="{% url 'event_list' %}?search=Workshop">
        <span class="cat-name">Workshops</span><span class="cat-count">Aprendizado prático</span>
      </a>
      <a class="cat-card" href="{% url 'event_list' %}?search=Esporte">
        <span class="cat-name">Esportes</span><span class="cat-count">Competições e partidas</span>
      </a>
    </div>
  </section>

  <!-- Seção de preços -->
  <section class="pricing" aria-label="Planos e preços">
    <h2 class="mb-2">Planos simples para começar</h2>
    <div class="price-grid">
      <div class="price-card">
        <h3>Starter</h3>
        <div class="price">R$ 0</div>
        <ul class="features">
          <li>Publicação de eventos ilimitados</li>
          <li>Pagamentos via PIX e cartão</li>
          <li>Relatórios básicos</li>
        </ul>
        <a class="btn btn-primary" href="{% url 'users:register' %}">Começar agora</a>
      </div>
      <div class="price-card">
        <h3>Pro</h3>
        <div class="price">R$ 49/mês</div>
        <ul class="features">
          <li>Cupons e campanhas</li>
          <li>Dashboard avançada</li>
          <li>Suporte prioritário</li>
        </ul>
        <a class="btn btn-primary" href="{% url 'users:register' %}">Experimentar grátis</a>
      </div>
      <div class="price-card">
        <h3>Enterprise</h3>
        <div class="price">Sob consulta</div>
        <ul class="features">
          <li>Integrações personalizadas</li>
          <li>Onboarding dedicado</li>
          <li>SLAs e compliance</li>
        </ul>
        <a class="btn btn-primary" href="{% url 'users:register' %}">Fale com vendas</a>
      </div>
    </div>
  </section>
{% endblock %}

{% block extra_js %}
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <script>
    const swiper = new Swiper('.swiper', {
      slidesPerView: 1,
      spaceBetween: 12,
      loop: true,
      pagination: { el: '.swiper-pagination', clickable: true },
      navigation: { nextEl: '.swiper-button-next', prevEl: '.swiper-button-prev' },
      autoplay: { delay: 5000, disableOnInteraction: false },
      a11y: { enabled: true },
    });
  </script>
{% endblock %}